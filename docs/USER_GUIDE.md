# 视功能自动分析App - 使用指南

## 🚀 运行应用

### 方式一：使用VS Code（推荐）

1. **打开项目**
   ```bash
   cd /Users/wanlongyi/project/vibe_project/glasess-analyze
   code .
   ```

2. **选择设备**
   - 按 `F5` 或点击菜单 `Run > Start Debugging`
   - 或点击右下角的设备选择器，选择：
     - `Chrome (web)` - 在浏览器中运行
     - `macOS (desktop)` - 在桌面运行
     - 或连接的真机/模拟器

3. **等待编译**
   - 首次运行需要下载依赖（约5-10分钟）
   - 编译完成后自动打开应用

### 方式二：命令行运行

```bash
# 进入项目目录
cd /Users/wanlongyi/project/vibe_project/glasess-analyze

# 获取依赖
flutter pub get

# 运行应用
flutter run

# 或指定设备
flutter run -d chrome        # 在Chrome浏览器运行
flutter run -d macos         # 在macOS桌面运行
flutter run -d <device_id>   # 在指定设备运行
```

### 方式三：使用Android Studio/Xcode

1. **Android Studio**:
   - 打开项目文件夹
   - 选择设备（模拟器或真机）
   - 点击运行按钮 ▶️

2. **Xcode** (iOS):
   - 打开 `ios/Runner.xcworkspace`
   - 选择设备
   - 点击运行按钮

---

## 📱 应用使用流程

### 第一步：打开应用
启动后会看到 **首页**：
```
┌─────────────────────────────────┐
│        [眼睛图标]               │
│                                 │
│      视功能自动分析             │
│   专业视功能检查数据分析工具    │
│                                 │
│  [📝 新建检查]                  │
│  [👥 患者列表]                  │
└─────────────────────────────────┘
```

### 第二步：新建检查

1. **点击"新建检查"按钮**

2. **选择检查类型**：
   - 🏥 **标准眼科全套** - 包含视力、屈光、眼压、调节等全套检查
   - 👁️ **视功能专项** - 专注双眼视功能评估
   - 👶 **儿童弱视筛查** - 针对儿童特点的检查
   - 😴 **视疲劳评估** - 针对视疲劳相关指标

3. **选择录入方式**：
   - 📝 **手动录入** - 直接输入数值
   - 📷 **拍照识别** - 拍摄检查单自动识别

### 第三步：数据录入

**手动录入界面**：
```
┌─────────────────────────────────┐
│ 指标名称                        │
│ 指标说明文字                    │
│ [必填]                          │
│ ┌───────────────────┐           │
│ │ 请输入数值    单位 │           │
│ └───────────────────┘           │
└─────────────────────────────────┘
```

**可录入的指标**（8项）：
- 裸眼远视力（右眼/左眼）
- 球镜度数（右眼/左眼）
- 眼压（右眼/左眼）
- 调节幅度（右眼/左眼）

**提示**：
- 输入数值后会实时校验
- 必填项有红色标记
- 可以点击"保存草稿"暂存数据

### 第四步：查看分析报告

点击"开始分析"后进入 **分析报告页**：

```
┌─────────────────────────────────┐
│ 📊 分析概览                     │
│ ├─ 检查项目总数: 8项            │
│ ├─ 异常指标数: 2项              │
│                                 │
│ [总体评估文字]                  │
├─────────────────────────────────┤
│ ⚠️ 异常指标详情                 │
│ ├─ 视力 0.8 - 轻度异常 ▼        │
│ │   医学解读: 轻度视力下降      │
│ │   可能原因: 屈光不正...       │
│ │   处理建议: 验光检查...       │
├─────────────────────────────────┤
│ 🔍 关键发现                     │
│ ├─ 1. 视力: 0.8 - 轻度视力下降  │
├─────────────────────────────────┤
│ 💡 综合建议                     │
│ ├─ ☑️ 验光检查                  │
│ ├─ ☑️ 排除眼部器质性病变        │
└─────────────────────────────────┘
```

**操作按钮**：
- 📄 **导出PDF** - 生成专业报告文件
- 📤 **分享** - 分享到微信/邮件
- 💾 **保存到患者** - 关联到患者档案

### 第五步：患者管理（可选）

**患者列表页**：
```
┌─────────────────────────────────┐
│ 🔍 搜索患者...                  │
│ ├─ 👤 张三 | 25岁 | 男          │
│ │   检查次数: 3次               │
│ ├─ 👤 李四 | 8岁  | 女          │
│ │   检查次数: 1次               │
│ [➕ 添加患者]                   │
└─────────────────────────────────┘
```

**患者详情页**：
- 查看基本信息
- 查看历史检查记录
- 新建检查（自动关联）

---

## 🎯 核心功能演示

### 1️⃣ 自动分析示例

**输入数据**：
- 裸眼远视力（右眼）: 0.8
- 球镜（右眼）: -2.50D

**自动分析结果**：
- 🔴 视力 0.8 - **轻度异常**
  - 医学解读: 轻度视力下降
  - 可能原因: 屈光不正、早期白内障
  - 处理建议: 验光检查、排除眼部器质性病变

- 🟠 球镜 -2.50D - **中度近视**
  - 医学解读: 中度近视
  - 可能原因: 轴性近视
  - 处理建议: 配戴合适眼镜、定期复查

### 2️⃣ OCR拍照识别示例

1. 点击"从OCR导入"
2. 选择"相机"或"相册"
3. 对准检查单拍照
4. 自动识别并填入：
   - 视力: 1.0
   - 屈光度: -1.50D
   - 眼压: 16mmHg
5. 确认后自动填入表单

### 3️⃣ PDF报告导出示例

1. 在分析报告页点击"导出PDF"
2. 等待生成（约2-3秒）
3. 自动保存到本地
4. PDF包含：
   - 患者信息
   - 所有检查数据
   - 异常指标标记
   - 医学解读
   - 处理建议
   - 检查日期

---

## 📋 快速上手指南

### 场景1：快速体验
```
1. 打开App
2. 点击"新建检查"
3. 选择"标准眼科全套"
4. 选择"手动录入"
5. 输入几个数值（如：视力0.8，屈光度-2.0）
6. 点击"开始分析"
7. 查看分析报告
```

### 场景2：完整流程
```
1. 打开App
2. 点击"患者列表"
3. 点击"添加患者"（输入姓名、年龄、性别）
4. 选择该患者，点击"新建检查"
5. 录入检查数据
6. 分析并导出PDF
7. 在患者详情中查看历史记录
```

### 场景3：使用OCR
```
1. 打开App
2. 点击"新建检查"
3. 选择检查类型
4. 点击"从OCR导入"
5. 拍摄检查单
6. 确认识别结果
7. 开始分析
```

---

## 🔧 常见问题

### Q1: 运行报错怎么办？
**A**: 
1. 确保Flutter SDK已安装: `flutter doctor`
2. 获取依赖: `flutter pub get`
3. 清理缓存: `flutter clean`
4. 重新运行: `flutter run`

### Q2: OCR识别不准确怎么办？
**A**:
1. 确保检查单清晰可见
2. 光线充足，避免反光
3. 尽量拍摄完整检查单
4. 可手动修正识别结果

### Q3: 如何添加更多患者？
**A**:
1. 在首页点击"患者列表"
2. 点击浮动按钮"添加患者"
3. 填写患者信息
4. 保存后可在列表中看到

### Q4: 报告可以打印吗？
**A**: 
- 可以！导出PDF后可以使用系统打印功能
- 或在PDF查看器中选择打印

### Q5: 数据会丢失吗？
**A**:
- 不会。所有数据保存在本地SQLite数据库
- 即使关闭应用，数据依然保留
- 可以在患者列表中随时查看历史记录

---

## 📱 界面截图示意

### 首页
```
┌──────────────────────┐
│                      │
│     [眼睛图标]       │
│                      │
│  视功能自动分析      │
│                      │
│ [新建检查]          │
│ [患者列表]          │
│                      │
└──────────────────────┘
```

### 检查类型选择
```
┌──────────────────────┐
│ 选择检查类型         │
│                      │
│ ┌─────────────────┐  │
│ │ 🏥 标准眼科全套 │  │
│ │ 15-20分钟       │  │
│ │ 25项指标        │  │
│ └─────────────────┘  │
│                      │
│ ┌─────────────────┐  │
│ │ 👁️ 视功能专项  │  │
│ │ 10-15分钟       │  │
│ │ 15项指标        │  │
│ └─────────────────┘  │
└──────────────────────┘
```

### 数据录入
```
┌──────────────────────┐
│ 数据录入      [保存] │
│                      │
│ 裸眼远视力（右眼）   │
│ 未矫正状态下的...    │
│ [必填]               │
│ ┌────────────────┐   │
│ │ 0.8            │   │
│ └────────────────┘   │
│                      │
│ 球镜（右眼）         │
│ 近视或远视度数       │
│ ┌────────────────┐   │
│ │ -2.50      D   │   │
│ └────────────────┘   │
│                      │
│     [开始分析]       │
└──────────────────────┘
```

### 分析报告
```
┌──────────────────────┐
│ 分析报告    [📄] [📤]│
│                      │
│ 📊 分析概览          │
│ 总指标: 8  异常: 2   │
│                      │
│ 检查发现2项指标轻度  │
│ 异常，建议...        │
│                      │
│ ⚠️ 异常指标          │
│ ┌─────────────────┐  │
│ │ 视力 0.8 轻度 ▼ │  │
│ │ 医学解读...      │  │
│ │ 可能原因...      │  │
│ │ 处理建议...      │  │
│ └─────────────────┘  │
│                      │
│ 💡 综合建议          │
│ ☑️ 验光检查          │
│ ☑️ 定期复查          │
└──────────────────────┘
```

---

## 🎉 开始体验

现在您可以运行应用了！使用以下命令：

```bash
cd /Users/wanlongyi/project/vibe_project/glasess-analyze
flutter run -d chrome
```

或按照上面的方式一/方式二运行。

**提示**: 首次运行需要下载依赖，请耐心等待5-10分钟。

---

*最后更新*: 2026-02-18  
*版本*: 1.0.0+1
